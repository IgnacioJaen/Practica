<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bo.ucb.edu.ingsoft.dao.MessagesDao">
    <select id="findMessagesById" resultType="bo.ucb.edu.ingsoft.model.Messages">
        SELECT
               message_id as messageId,
               chat_id as chatId,
               date as date,
               content as content,
               status as status,
               tx_id as txId,
               tx_host as txHost,
               tx_user as txUserId,
               tx_date as txDate,
               tx_update as txUpdate
        FROM messages
        WHERE
            message_id = #{messageId} and status=1
    </select>

    <select id="findMessagesReqById" resultType="bo.ucb.edu.ingsoft.dto.MessagesRequest">
        SELECT
               message_id as messageId,
               date as date,
               content as content
        FROM messages
        WHERE
            message_id = #{messageId} and status=1
    </select>

    <insert id="messagesInsert" parameterType="bo.ucb.edu.ingsoft.model.Messages">
        INSERT INTO messages VALUES (
            null, #{chatId}, #{date}, #{content}, 1, #{transaction.txId}, #{transaction.txHost},
            #{transaction.txUserId}, #{transaction.txDate}, #{transaction.txUpdate}
        )
    </insert>


    <delete id="messagesDelete" parameterType="bo.ucb.edu.ingsoft.model.Messages">
        UPDATE messages
        SET status = 0
        WHERE message_id = #{messageId}
        </delete>
</mapper>